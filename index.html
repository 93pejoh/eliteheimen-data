<!doctype html>
<html lang="no">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Eliteheimen</title>
<meta name="description" content="Eliteheimen – interaktiv spilleroversikt for Fantasy Eliteserien." />

<!-- Fonter og favicon -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="icon" href="logo.png">

<style>
  :root {
    --radius: 14px;
    --surface: #ffffff;
    --text: #0f172a;
    --muted: #667085;
    --border: #e5e7eb;
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    margin: 20px; color: var(--text); background: #fafafa;
  }

  /* Hero / header */
  .hero {
    position: relative; overflow: hidden; border-radius: var(--radius);
    padding: 18px; margin-bottom: 12px; color: #fff;
    background:
      radial-gradient(80% 120% at 10% -10%, rgba(14,165,233,.25), transparent 40%),
      radial-gradient(80% 120% at 110% 10%, rgba(34,197,94,.25), transparent 40%),
      linear-gradient(180deg, #0b1220, #111827);
    border: 1px solid rgba(255,255,255,.06);
  }
  .hero-inner { display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
  .brand {
    display:flex; gap:12px; align-items:center;
    backdrop-filter: blur(6px);
    border-radius: 999px; padding:8px 12px;
    background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.12);
  }
  .brand img { width:48px; height:48px; border-radius: 12px; object-fit: cover; background:#fff; }
  .brand h1 { margin:0; font-size: 1.5rem; font-weight: 800; letter-spacing: .2px; }

  .quicknav { margin-top: 8px; display:flex; gap:8px; flex-wrap: wrap; }
  .qbtn {
    padding:8px 12px; border-radius: 999px; border:1px solid rgba(255,255,255,.18);
    background: rgba(255,255,255,.06); color:#e5e7eb; text-decoration:none; font-weight:600;
  }
  .qbtn:hover { border-color: rgba(255,255,255,.35); }

  .toolbar { display:flex; gap:8px; align-items:center; }
  .toggle {
    display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px;
    border:1px solid #3b4152; cursor:pointer; user-select:none; background:rgba(255,255,255,.06); color:#e5e7eb;
  }

  /* KPI-kort */
  .cards { display:grid; gap:10px; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); margin: 10px 0 14px; }
  .card {
    background: var(--surface); color: var(--text); border:1px solid #eef2f7; border-radius: var(--radius);
    padding: 12px 14px; box-shadow: 0 1px 0 rgba(15,23,42,.04);
  }
  .card h3 { margin:0 0 .25rem; font-size:.95rem; color:#111827; }
  .card p { margin:0; color: var(--muted); font-size:.92rem; }

  /* Kontroller & filter */
  .controls { display: grid; grid-template-columns: 1fr auto auto auto; gap: 8px; align-items: center; margin: 8px 0; }
  input[type="search"] { padding: 8px 10px; border: 1px solid #ccc; border-radius: var(--radius); outline: none; }
  input[type="search"]:focus { border-color: #888; }
  button { padding: 6px 10px; border: 1px solid #ddd; border-radius: var(--radius); background: #fff; cursor: pointer; }
  label.switch { display: inline-flex; align-items: center; gap: 6px; user-select: none; }
  .pill { border: 1px solid #e0e0e0; border-radius: 999px; padding: 4px 10px; background: #fff; }
  .row { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; margin: 6px 0 8px; }
  .chip { border: none; border-radius: 999px; padding: 4px 10px; background: #f2f4f7; cursor: pointer; user-select: none; }
  .chip[aria-pressed="true"] { background: #dbeafe; outline: 2px solid #93c5fd; }
  .chip:active { transform: scale(0.98); }

  /* Pris – kompakt slider */
  .price-compact { display: inline-flex; align-items: center; gap: 8px; margin: 2px 0 8px; }
  .price-compact input[type="range"] { width: 220px; height: 4px; }
  .muted { color: #666; font-size: .88rem; }

  /* Tabell */
  .table-wrap { overflow: auto; border: 1px solid #e5e5e5; border-radius: var(--radius); background:#fff; }
  table { border-collapse: collapse; width: 100%; font-size: 0.95rem; }
  thead th { position: sticky; top: 0; background: #fafafa; border-bottom: 1px solid #e5e5e5; padding: 8px; white-space: nowrap; text-align: center; }
  tbody td { border-top: 1px solid #f0f0f0; padding: 6px 8px; vertical-align: top; white-space: nowrap; text-align: center; }
  thead th button { background: transparent; border: none; font: inherit; cursor: pointer; }
  .sort-ind { opacity: .6; font-size: .9em; margin-left: 6px; }
  tbody tr:nth-child(even) td { background: #fcfcfc; }
  tbody tr:hover td { background: #f3f7ff; }
  tbody td:first-child, thead th:first-child {
    position: sticky; left: 0; z-index: 1; background: #fff;
    box-shadow: 1px 0 0 #eee;
  }

  .legend { font-size: .9rem; color: #666; margin-top: 6px; }
  .footer-wrap {
    margin-top: 18px; padding-top: 12px; border-top: 1px solid #e5e7eb; color: #64748b;
    display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between;
  }
  .footer-wrap a { color:#64748b; text-decoration:none; }
  .footer-wrap a:hover { color:#0ea5e9; }

  /* Dark mode */
  html.dark body { background:#0b1220; color:#e5e7eb; }
  html.dark .card { background:#0f172a; color:#e5e7eb; border-color:#1f2a44; }
  html.dark .controls input[type="search"], html.dark button, html.dark .pill { background:#0f172a; color:#e5e7eb; border-color:#1f2a44; }
  html.dark .chip { background:#111827; color:#e5e7eb; }
  html.dark .chip[aria-pressed="true"] { background:#1f2937; outline-color:#334155; }
  html.dark .table-wrap { border-color:#1f2a44; background:#0f172a; }
  html.dark thead th { background:#0f172a; border-bottom-color:#1f2a44; }
  html.dark tbody td { border-top-color:#15213b; }
  html.dark tbody tr:hover td { background:#0d1a34; }
  html.dark .legend, html.dark .footer-wrap { color:#a3adc2; }
</style>
</head>
<body>

  <!-- HERO -->
  <section class="hero" id="top">
    <div class="hero-inner">
      <div class="brand">
        <img src="logo.png" alt="Eliteheimen logo" />
        <div><h1>Eliteheimen</h1></div>
      </div>
      <div class="toolbar">
        <nav class="quicknav" aria-label="Hurtignavigasjon">
          <a class="qbtn" href="#filters">Filtre</a>
          <a class="qbtn" href="#table">Tabell</a>
        </nav>
        <label class="toggle"><input type="checkbox" id="darkToggle"> Mørk modus</label>
      </div>
    </div>
  </section>

  <!-- KPI-KORT -->
  <section class="cards">
    <div class="card"><h3>Spillere vist</h3><p id="kpi-count">–</p></div>
  </section>

  <!-- Filtre -->
  <section id="filters">
    <div class="controls" role="region" aria-label="Kontroller">
      <input id="q" type="search" placeholder="Søk i synlige kolonner…" aria-label="Globalt søk" />
      <div class="pill"><span id="shown">0</span>/<span id="total">0</span> rader</div>
      <label class="switch" title="Skru av/på fargelegging">
        <input type="checkbox" id="condfmt" checked /> Betinget formatering
      </label>
      <button id="reset" type="button">Nullstill</button>
    </div>

    <div class="row" role="region" aria-label="Posisjonsfilter">
      <strong>Posisjoner:</strong>
      <button class="chip" id="pos-all" aria-pressed="true">Alle</button>
      <div id="pos-chips" class="row" style="margin:0;"></div>
    </div>

    <div id="price-compact" class="price-compact" style="display:none;">
      <strong>Pris ≤</strong>
      <input id="priceCapRange" type="range" step="1" />
      <span class="muted" id="priceCapLabel"></span>
    </div>
  </section>

  <section id="table" class="table-wrap" aria-labelledby="top">
    <table id="tbl" aria-describedby="q">
      <thead id="thead"></thead>
      <tbody id="tbody"></tbody>
    </table>
  </section>
  <div class="legend">R23–R28: rød → grønn (kraftig kontrast). NESTE 6: lys → mørk blå (egen skala). NAVN og NESTE 6 i bold.</div>

  <footer class="footer-wrap" id="about">
    <div>© 2025 Eliteheimen. Data fra GitHub-repoet.</div>
    <div>
      <a href="https://github.com/93pejoh/eliteheimen-data" target="_blank" rel="noopener">GitHub</a>
      &nbsp;•&nbsp;
      <a href="#top">Til toppen ↑</a>
    </div>
  </footer>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
  const CSV_URL = "https://raw.githubusercontent.com/93pejoh/eliteheimen-data/refs/heads/main/Eliteheimen%20%E2%80%93%20runde%2023.csv";
  const HIDE_BY_LETTER = ["F","H","J","L","N","P","R"];
  const HIDE_COLUMNS = [];
  const GROUP_COLUMNS = ["R23","R24","R25","R26","R27","R28"];
  const NESTE6_COLUMN = "NESTE 6";
  const NAME_PREF = "navn";

  // (resten av scriptet er likt som tidligere)
  // men med OPPDATERT colorGroup:

  function colorGroup(val, min, max, invert=false){
    if (!isNumericLike(val)) return '';
    const x = toNumber(val);
    if(!isFinite(x)||!isFinite(min)||!isFinite(max)||max<=min) return '';
    let t=(x-min)/(max-min);
    if (invert) t=1-t;
    const hue=0 + t*120;          // 0=rød, 120=grønn
    const sat=95;                 // høy metning
    const light=98 - t*44;        // stort lys/mørk spenn
    const text=light<=70?'#fff':'inherit';
    return `background:hsl(${hue} ${sat}% ${light}%);color:${text}`;
  }

  // resten av JS-en kan være identisk med den du hadde før
</script>
</body>
</html>
